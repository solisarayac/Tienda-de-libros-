<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sistema de Pr√©stamos de Libros</title>
    <!-- Link al CSS principal -->
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- Contenedor principal de toda la p√°gina -->
    <div class="container">
      
      <!-- Header: t√≠tulo y secci√≥n de login/usuario -->
      <header>
        <h1>üìö Biblioteca Escolar</h1>

        <!-- Secci√≥n de botones de autenticaci√≥n (login/registro) -->
        <div id="auth-section" class="auth-buttons">
          <button onclick="showLogin()">Iniciar Sesi√≥n</button>
          <button onclick="showRegister()">Registrarse</button>
        </div>

        <!-- Secci√≥n que se muestra al usuario ya logueado -->
        <div id="user-section" style="display: none" class="user-info">
          <!-- Nombre del usuario logueado -->
          <span id="user-name"></span>
          <!-- Bot√≥n para cerrar sesi√≥n -->
          <button onclick="logout()">Cerrar Sesi√≥n</button>
        </div>
      </header>

      <!-- Navegaci√≥n principal -->
      <nav id="main-nav" style="display: none">
        <button onclick="showSection('books')">Libros</button>
        <button onclick="showSection('loans')">Mis Pr√©stamos</button>
        <!-- Solo visible para administradores -->
        <button onclick="showSection('admin')" id="admin-btn" style="display: none">
          Administraci√≥n
        </button>
      </nav>

      <!-- Contenido principal -->
      <main>

        <!-- Secci√≥n de formularios de autenticaci√≥n -->
        <div id="auth-forms">
          <!-- Formulario de login -->
          <div id="login-form" class="form-container">
            <h2>Iniciar Sesi√≥n</h2>
            <input type="email" id="login-email" placeholder="Email" required />
            <input type="password" id="login-password" placeholder="Contrase√±a" required />
            <button onclick="login()">Ingresar</button>
            <!-- Mensaje de error din√°mico -->
            <p id="login-error" class="error-message"></p>
          </div>

          <!-- Formulario de registro -->
          <div id="register-form" class="form-container" style="display: none">
            <h2>Registrarse</h2>
            <input type="text" id="register-name" placeholder="Nombre completo" required />
            <input type="email" id="register-email" placeholder="Email" required />
            <input type="password" id="register-password" placeholder="Contrase√±a" required minlength="6" />
            <select id="register-rol" onchange="toggleGradoField()">
              <option value="estudiante">Estudiante</option>
              <option value="profesor">Profesor</option>
              <option value="administrador">Administrador</option>
            </select>
            <!-- Campo extra que solo se muestra para estudiantes -->
            <input type="text" id="register-grado" placeholder="Grado (solo estudiantes)" style="display: none" />
            <button onclick="register()">Registrarse</button>
            <p id="register-error" class="error-message"></p>
          </div>
        </div>

        <!-- Secci√≥n de libros -->
        <div id="books-section" class="section" style="display: none">
          <h2>Cat√°logo de Libros</h2>

          <!-- Filtros de b√∫squeda -->
          <div class="filters">
            <input type="text" id="search-books" placeholder="Buscar libros..." onkeyup="filterBooks()" />
            <select id="filter-category" onchange="filterBooks()">
              <option value="">Todas las categor√≠as</option>
              <option value="Novela">Novela</option>
              <option value="F√°bula">F√°bula</option>
              <option value="Ciencia ficci√≥n">Ciencia ficci√≥n</option>
              <option value="Romance">Romance</option>
              <option value="Novela cl√°sica">Novela cl√°sica</option>
            </select>
          </div>

          <!-- Contenedor donde se mostrar√°n los libros din√°micamente -->
          <div id="books-list" class="books-grid"></div>
        </div>

        <!-- Secci√≥n de pr√©stamos del usuario -->
        <div id="loans-section" class="section" style="display: none">
          <h2>Mis Pr√©stamos</h2>

          <!-- Filtro por estado del pr√©stamo -->
          <div id="loans-filter">
            <select id="filter-loan-status" onchange="loadLoans()">
              <option value="">Todos los estados</option>
              <option value="activo">Activos</option>
              <option value="atrasado">Atrasados</option>
              <option value="completado">Completados</option>
            </select>
          </div>

          <!-- Contenedor donde se mostrar√°n los pr√©stamos din√°micamente -->
          <div id="loans-list"></div>
        </div>

        <!-- Secci√≥n de administraci√≥n -->
        <div id="admin-section" class="section" style="display: none">
          <h2>Administraci√≥n</h2>

          <!-- Botones de acci√≥n administrativa -->
          <div class="admin-actions">
            <button onclick="showAddBookForm()" class="btn-primary">‚ûï Agregar Libro</button>
            <button onclick="loadAllLoans()" class="btn-secondary">üìã Ver Todos los Pr√©stamos</button>
          </div>

          <!-- Formulario de agregar libro -->
          <div id="add-book-form" class="form-container" style="display: none">
            <h3>Agregar Nuevo Libro</h3>
            <input type="text" id="book-title" placeholder="T√≠tulo *" required />
            <input type="text" id="book-author" placeholder="Autor *" required />
            <input type="text" id="book-editorial" placeholder="Editorial *" required />
            <input type="number" id="book-year" placeholder="A√±o de publicaci√≥n *" required min="1000" max="2024" />
            <input type="text" id="book-category" placeholder="Categor√≠a *" required />
            <input type="number" id="book-quantity" placeholder="Cantidad *" required min="1" />
            <input type="file" id="book-image" accept="image/*" />
            <div class="form-buttons">
              <button onclick="addBook()" class="btn-success">Agregar Libro</button>
              <button onclick="hideAddBookForm()" class="btn-danger">Cancelar</button>
            </div>
            <p id="add-book-error" class="error-message"></p>
          </div>

          <!-- Contenedor de todos los pr√©stamos del sistema -->
          <div id="all-loans-section" style="display: none">
            <h3>Todos los Pr√©stamos del Sistema</h3>
            <div id="all-loans-list"></div>
          </div>
        </div>

        <!-- Indicador de carga -->
        <div id="loading" style="display: none">
          <div class="loading-spinner"></div>
          <p>Cargando...</p>
        </div>
      </main>
    </div>

    <!-- Script principal -->
    <script src="script.js"></script>
  </body>
</html>
